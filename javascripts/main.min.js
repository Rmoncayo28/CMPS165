function mouseover(e){div.style("display","inline")}function mousemove(e){div.html("County Name: "+e.properties.county_name+"<br>Tract: "+e.properties.NAME+"<br>Total Population: "+e.properties.population+"<br> % of 18+ in College: "+e.properties.inColCent+"<br>% Insured: "+e.properties.percent_insured+"<br>% Uninsured: "+e.properties.percent_uninsured).style("left",d3.event.pageX-34+"px").style("top",d3.event.pageY-12+"px")}function mouseout(e){div.style("display","none")}function changeData(e,t){"health"===t.toLowerCase()?(e.transition().style("fill",function(e){return healthScale(parseFloat(e.properties.percent_insured,10)||0)}),e.on("click",function(e){void 0===selected[e.properties.NAME]?(selected[e.properties.NAME]=this,d3.select(this).style("fill","red")):(d3.select(this).style("fill",function(e){return healthScale(parseFloat(e.properties.percent_insured,10)||0)}),selected[e.properties.NAME]=void 0)})):"poverty"===t.toLowerCase()?(e.transition().style("fill",function(e){return povertyScale(parseFloat(e.properties.inColCent,10)||0)}),e.on("click",function(e){void 0===selected[e.properties.NAME]?(selected[e.properties.NAME]=this,d3.select(this).style("fill","red")):(d3.select(this).style("fill",function(e){return povertyScale(parseFloat(e.properties.inColCent,10)||0)}),selected[e.properties.NAME]=void 0)})):"education"===t.toLowerCase()&&(e.transition().style("fill",function(e){return educationScale(parseFloat(e.properties.inColCent,10)||0)}),e.on("click",function(e){void 0===selected[e.properties.NAME]?(selected[e.properties.NAME]=this,d3.select(this).style("fill","red")):(d3.select(this).style("fill",function(e){return educationScale(parseFloat(e.properties.inColCent,10)||0)}),selected[e.properties.NAME]=void 0)}))}function zoomed(){var e=d3.event,t=Math.min(0,Math.max(e.translate[0],width-width*e.scale)),r=Math.min(0,Math.max(e.translate[1],height-height*e.scale));zoom.translate([t,r]),g.attr("transform",["translate("+[t,r]+")","scale("+e.scale+")"].join(" "))}var width=1900,height=1e3,projection=d3.geo.mercator().scale(2*width).center([-120,36]).translate([280,height/2+50]),zoom=d3.behavior.zoom().scaleExtent([1,200]).on("zoom",zoomed),path=d3.geo.path().projection(projection),border=1,borderColor="black",svg=d3.select("#map").append("svg").attr("width",width).attr("height",height).attr("border",border).append("g");svg.call(zoom);var g=svg.append("g"),borderPath=svg.append("rect").attr("x",0).attr("y",0).attr("height",height).attr("width",width).style("stroke",borderColor).style("fill","none").style("stroke-width",border),educationScale=d3.scale.threshold().domain([2.67,5.34,10.68,44.66,100]).range(colorbrewer.Blues[5]),healthScale=d3.scale.threshold().domain([20.69875,41.3975,82.795,91.398,101]).range(colorbrewer.Greens[5]),povertyScale=d3.scale.threshold().domain([20.69875,41.3975,82.795,91.398,101]).range(colorbrewer.Purples[5]),selected={};d3.json("dataSets/caEduHealthBound.json",function(e,t){if(e)throw e;var r=(topojson.feature(t,t.objects.tracts),g.append("g").attr("transform","translate(450,-30)")),n=r.selectAll(".tract1").data(topojson.feature(t,t.objects.tracts).features).enter().append("g").attr("class","tract1").append("path").attr("class","tract").style("fill",function(e){return educationScale(parseFloat(e.properties.inColCent,10)||0)}).attr("d",path).on("mouseover",function(e){mouseover(e)}).on("mouseout",function(e){mouseout(e)}).on("mousemove",function(e){mousemove(e)}).on("click",function(e){if(void 0===selected[e.properties.NAME]){selected[e.properties.NAME]=this,d3.select(this).style("fill","red");var t=document.getElementById("table1"),r=document.createElement("TR");r.setAttribute("id","row"+e.properties.NAME);var n=document.createElement("TD");n.innerHTML=e.properties.NAME,r.appendChild(n),n=document.createElement("TD"),n.innerHTML=e.properties.county_name,r.appendChild(n),n=document.createElement("TD"),n.innerHTML=e.properties.population,r.appendChild(n),n=document.createElement("TD"),n.innerHTML=e.properties.inColCent,r.appendChild(n),n=document.createElement("TD"),n.innerHTML=e.properties.percent_insured,r.appendChild(n),t.appendChild(r)}else{d3.select(this).style("fill",function(e){return educationScale(parseFloat(e.properties.inColCent,10)||0)}),selected[e.properties.NAME]=void 0;var o=document.getElementById("row"+e.properties.NAME);o.parentElement.removeChild(o)}}),o=350,a=330,i=r.selectAll(".legend1").data(educationScale.domain(),function(e){return e}).enter().append("g").attr("class","legend1").attr("transform",function(e,t){return"translate("+50*t+", 0 )"});i.append("rect").attr("x",o).attr("y",a).attr("width",50).attr("height",15).style("fill",function(e,t){return colorbrewer.Blues[5][t]}),i.append("text").attr("x",o+13).attr("y",a+25).attr("dy",".35em").text(function(e){return d3.round(e)+"%"}),r.append("text").attr("class","legend1-caption").attr("x",o+5).attr("y",a-6).attr("font-size","12px").text("% of population age 18 and over enrolled in college");var l=g.append("g").attr("transform","translate(650,-30)").attr("visibility","hidden"),s=(l.selectAll(".tract2").data(topojson.feature(t,t.objects.tracts).features).enter().append("g").attr("class","tract2").append("path").attr("class","tract").style("fill",function(e){return educationScale(parseFloat(e.properties.inColCent,10)||0)}).attr("d",path).on("mouseover",function(e){mouseover(e)}).on("mouseout",function(e){mouseout(e)}).on("mousemove",function(e){mousemove(e)}).on("click",function(e){void 0===selected[e.properties.NAME]?(selected[e.properties.NAME]=this,d3.select(this).style("fill","red")):(d3.select(this).style("fill",function(e){return educationScale(parseFloat(e.properties.inColCent,10)||0)}),selected[e.properties.NAME]=void 0)}),350),d=330,c=l.selectAll(".legend2").data(educationScale.domain(),function(e){return e}).enter().append("g").attr("class","legend2").attr("transform",function(e,t){return"translate("+50*t+", 0 )"});c.append("rect").attr("x",s).attr("y",d).attr("width",50).attr("height",15).style("fill",function(e,t){return colorbrewer.Blues[5][t]}),c.append("text").attr("x",s+13).attr("y",d+25).attr("dy",".35em").text(function(e){return d3.round(e)+"%"}),l.append("text").attr("class","legend1-caption").attr("x",s+5).attr("y",d-6).attr("font-size","12px").text("% of population age 18 and over enrolled in college"),d3.select("#dropdown").on("change",function(){var e=d3.select(this).property("value");"education"==e?changeData(n,"education"):"health"==e?changeData(n,"health"):"poverty"==e&&changeData(n,"poverty")}),d3.selectAll(".overlay_button").on("change",function(){var e=this.id;switch(e){case"education_box":break;case"health_box":break;case"poverty_box":}}),d3.selectAll(".radio").on("change",function(){document.getElementById("single").checked?(d3.select("#dropdown").style("opacity",1),r.transition().duration(750).attr("transform","translate(450,-30)"),l.transition().duration(750).attr("visibility","hidden").attr("transform","translate(650,-30)")):document.getElementById("side-by-side").checked&&(d3.select("#dropdown").style("opacity",0),r.transition().duration(750).attr("transform","translate(25,-30)"),l.transition().duration(750).attr("visibility","visible").attr("transform","translate(650,-30)"))})});var div=d3.select("body").append("div").attr("class","tooltip").style("display","none");d3.select(self.frameElement).style("height",height+"px");