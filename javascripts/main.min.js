function mouseover(e){div.style("display","inline")}function mousemove(e){div.html("County Name: "+e.properties.county_name+"<br>Tract: "+e.properties.NAME+"<br>Total Population: "+e.properties.population+"<br> % of 18+ in College: "+e.properties.inColCent+"<br>% Insured: "+e.properties.percent_insured+"<br>% Uninsured: "+e.properties.percent_uninsured).style("left",d3.event.pageX-34+"px").style("top",d3.event.pageY-12+"px")}function mouseout(e){div.style("display","none")}function zoomed(){var e=d3.event,t=Math.min(0,Math.max(e.translate[0],width-width*e.scale)),a=Math.min(0,Math.max(e.translate[1],height-height*e.scale));zoom.translate([t,a]),g.attr("transform",["translate("+[t,a]+")","scale("+e.scale+")"].join(" "))}var incrementColor=function(e,t){var a=parseInt(e.substr(1),16),o=parseInt(t);if(!isNaN(a)&&!isNaN(o)){a+=o;var r=a.toString(16);if(r="#"+new Array(7-r.length).join(0)+r,/^#[0-9a-f]{6}$/i.test(r))return r}return e},width=1900,height=1e3,projection=d3.geo.mercator().scale(2*width).center([-120,36]).translate([280,height/2+50]),zoom=d3.behavior.zoom().scaleExtent([1,200]).on("zoom",zoomed),path=d3.geo.path().projection(projection),svg=d3.select("#map").append("svg").attr("width",width).attr("height",height).append("g");svg.call(zoom);var g=svg.append("g"),color=d3.scale.threshold().domain([1,10,50,100,500,1e3,2e3,5e3]).range(["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]),tractScale=d3.scale.threshold().domain([2.67,5.34,10.68,44.66,101]).range(colorbrewer.Blues[5]),horizontalLegend=d3.svg.legend().cellWidth(130).units("% pop in col").cellHeight(25).inputScale(tractScale).cellStepping(120);d3.select("svg").append("g").attr("transform","translate(290,70)").attr("class","legend").call(horizontalLegend);var formatNumber=d3.format(",d"),x=d3.scale.linear().domain([0,5100]).range([0,480]),xAxis=d3.svg.axis().scale(x).orient("bottom").tickSize(13).tickValues(color.domain()).tickFormat(function(e){return e>=100?formatNumber(e):null}),selected={};d3.json("dataSets/caEduHealthBound.json",function(e,t){if(e)throw e;var r=(topojson.feature(t,t.objects.tracts),g.selectAll(".tract1").data(topojson.feature(t,t.objects.tracts).features).enter().append("g").attr("class","tract1").append("path").attr("class","tract").style("fill",function(e){return tractScale(parseFloat(e.properties.inColCent,10)||0)}).attr("d",path).on("mouseover",function(e){mouseover(e)}).on("mouseout",function(e){mouseout(e)}).on("mousemove",function(e){mousemove(e)}).on("click",function(e){void 0===selected[e.properties.NAME]?(selected[e.properties.NAME]=this,d3.select(this).style("fill","red")):(d3.select(this).style("fill",function(e){return tractScale(parseFloat(e.properties.inColCent,10)||0)}),selected[e.properties.NAME]=void 0)}),g.selectAll(".tract2").data(topojson.feature(t,t.objects.tracts).features)),n=r.enter().append("g").attr("class","tract2").attr("transform","translate(500,0)").style("opacity",0);n.append("path").attr("class","tract").style("fill",function(e){return tractScale(parseFloat(e.properties.inColCent,10)||0)}).attr("d",path),d3.select("#dropdown").on("change",function(){d3.select(this).property("value")}),d3.selectAll(".radio").on("change",function(){document.getElementById("single").checked?n.on("mouseover",function(e){}).on("mouseout",function(e){}).on("mousemove",function(e){}).transition().duration(850).style("opacity",0):document.getElementById("side-by-side").checked&&n.on("mouseover",function(e){mouseover(e)}).on("mouseout",function(e){mouseout(e)}).on("mousemove",function(e){mousemove(e)}).transition().duration(850).style("opacity",1)})});var div=d3.select("body").append("div").attr("class","tooltip").style("display","none");d3.select(self.frameElement).style("height",height+"px");
